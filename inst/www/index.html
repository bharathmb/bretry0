<!Doctype html5>
<html>

<head>
  <title>Propensity Model</title>
    <script src="opencpu/jquery-1.10.2.min.js"></script>
    <script src="opencpu/opencpu-0.4.js"></script>

	<script>

$(document).ready(function(){
  
  function uploadcsv(filename){
	 alert("inside uploadcsv....");
    //disable the button during upload
    $("#submitbutton").attr("disabled", "disabled");  
    //perform the request
    var req = ocpu.call("read_csv", {
      file : filename
    }, function(session){
      //on success call printsummary()
      printsummary(session);
    });
    
    //if R returns an error, alert the error message
    req.fail(function(){
      alert("Server error: " + req.responseText);
    });
    
    //after request complete, re-enable the button 
    req.always(function(){
      $("#submitbutton").removeAttr("disabled")
    });        
  }    
  
  
  function printsummary(mydata){
	  alert("inside printsummary....");
    //perform the request
    var req = ocpu.call("printsummary", {
      df_full : mydata
    }, function(session){
      session.getConsole(function(output){
        $("#output code").text(output);	
	
		//FUNCTION CALLS TO SIGNIFICANT VARIABLE LIST & GRAPHS PLOTS
	  //plot_graph();
      	  add_var_list();
    }).fail(function(){
      alert("Server error: " + req.responseText);
    });        
  });
  }
  
  
		//Adding code for var_list call
	
		function add_var_list()
			{
				alert("inside Add Options");
				var vars;
				var req = ocpu.call("imp_var_list", {	"target.var.name" : dvname	}, 
			function(session){
				session.getObject(function(data){
				//$("#output code").text(data);	
				alert("imp_var_list ends: trying to append" );
				
				for (var i=0; i < data.length;++i)
				{
					alert("inside_for " + i);
					var x = document.getElementById("DropList");
					var option = document.createElement("option");
					option.text = data[i];
					x.add(option);
					
					alert("option " + i + " added")
					
					//addOption(document.DropList, data[i], data[i]);
					
				}

				}).fail(function(){
					alert("R returned an error in var_list: " + req.responseText);
					});
				});
				
				}
				
	
		//VAR LIST CALL ENDS
		
		//Adding COde for Significant variables graph
				function plot_graph()
			{
				alert("inside Plot graph");
				
				//var req = $("#plotdiv").rplot("top_var_graph", {"target.var.name" : dvname});
				
				var req = $("#plotdiv").rplot("randomplot", {	n : 100, dist : "normal"})
				
				//if R returns an error, alert the error message
				req.fail(function(){
				alert("Server error: " + req.responseText);
				});
				
				//after request complete, re-enable the button 
				req.always(function(){
				$("#submitbutton").removeAttr("disabled")
				});
				alert("plotted");
		
			// var req = ocpu.call("top_var_graph", {
			//	"target.var.name" : dvname;
			//}, 
			//function(session){
			//	session.getObject(function(data){
			//	//$("#output code").text(data);	
			//	alert("trying to plot" );
			//	$("#plotdiv").rplot(req);
            //
			//	}).fail(function(){
			//		alert("R returned an error in graph: " + req.responseText);
			//		});
			//	});
				
			}
			//SIGNIFICANT GRAPH CALL ENDS
		
		
  
  $("#submitbutton").on("click", function(){
    
	alert("inside script....");
    //arguments
    //read the value for 'filename'
	var filename = $("#uploadFile").val();
	var dvname=$("#dvname").val()
    
    if(!filename){
      alert("No file selected.");
      return;
    }
	
	if(!dvname){
      alert("Please provide DV name.");
      return;
    }
	
	//disable the button to prevent multiple clicks
     $("#submitbutton").attr("disabled", "disabled");
  
	uploadcsv(filename); 
	
	alert("exited upload");
	
		n=1000;
		dist="normal";
        //create the plot area on the plotdiv element
        var req = $("#plotdiv").rplot("randomplot", {
          n : nfield,
          dist : distfield
        })

        //if R returns an error, alert the error message
        req.fail(function(){
          alert("Server error: " + req.responseText);
        });
        
        //after request complete, re-enable the button 
        req.always(function(){
          $("#submitbutton").removeAttr("disabled")
        });
      });
    });

  
  </script>
	
	
	
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no">
  <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <!-- <link href="css/bubbles.css" rel="stylesheet" type="text/css"> -->
  <link href="scss/style.css" rel="stylesheet" type="text/css">
  <link href="fontawesome/web-fonts-with-css/css/fontawesome-all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <script src="js/highcharts.js"></script>
  <script src="http://code.highcharts.com/highcharts-more.js"></script>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.appear/0.3.3/jquery.appear.js"></script>
      <style>
      p {
        height: 25px;
        width: 300px;
        border: 1px solid gray;
        padding: 3px;
		color:black;
		background-color : white;
      }
	  #output{
      min-height: 200px;
      border: solid gray 1px;
	  padding: 3px;
	  color:black;
	  background-color : white;
    }
     #plotdiv {
       position: relative;
       width: 600px;
       height: 400px;
       border: solid gray 1px;
     }
	      #plotdiv1 {
       position: relative;
       width: 400px;
       height: 400px;
       border: solid gray 1px;
     }
    </style>						
</head>

<body>
	


  <div id="background-wrap">
    <div class="bubble x1"></div>
    <div class="bubble x2"></div>
    <div class="bubble x3"></div>
    <div class="bubble x4"></div>
    <div class="bubble x5"></div>
    <div class="bubble x6"></div>
    <div class="bubble x7"></div>
    <div class="bubble x8"></div>
    <div class="bubble x9"></div>
    <div class="bubble x10"></div>
  </div>

  <!-- <div class="device-notification">
    <a class="device-notification--logo" href="#0">
      <p>Propensity Model</p>
    </a>
    <p class="device-notification--message">Global has so much to offer that we must request you orient your device to portrait or find a larger screen. You won't
      be disappointed.</p>
  </div> -->

  <div class="perspective effect-rotate-left">

    <!-- <div class="outer-nav--return"></div> -->

  <div id="viewport" class="l-viewport">
   <div class="container-main">
    <header>
      <div class="container-fluid">
        <div class="row">
          <div class="col-12">
            <div class="header-wrapper">
              <h5>Propensity Model</h5>
              <div class="header--nav-toggle">
                <span></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <div class="container-fluid body-margin">
      <div class="row">
        <div class="col-12">


          <div class="row">
            <div class="col-sm-2">
              <div class="side-nav-fixed">
                <ul class="side-nav">
                  <li class="is-active">
                    <span>Choose CSV File</span>
                  </li>
                  <li>
                    <span>Variable Profiling</span>
                  </li>
                  <li>
                    <span>Select the Model</span>
                  </li>
                  <li>
                    <span>View Results</span>
                  </li>
                  <li>
                    <span>Evaluate Model</span>
                  </li>
                </ul>

                <!-- <div>
                                <label>Powered by Latentview</label>
                        </div> -->

              </div>
            </div>

            <div class="col-sm-10">
              <div class="body-right-wrapper">
                <div class="row">
                  <div class="col-sm-12">
                    <ul class="l-main-content main-content">
					
                      <li class="l-section section section--is-active">
                        <div class="intro">

                          <h2><b>Choose CSV File</b></h2>
                          <div class="choose-data">
                            <span><b>Input Data File Path</b></span>
                            <span>
                              <input id="uploadFile" disabled="disabled" />
							  
                              <label class="custom-file-input">
                                <input type="file" id="uploadBtn">
                              </label>
                            </span>
			    <b>DV name: </b> <input type="text" id="dvname">

                            <b><button id="submitbutton" type="button">Upload</button></b>
					<pre id="output"><code></code></pre>	
                          </div>

                          <div class="lds-dual-ring">Cleaning in progress</div>

                        </div>
                      </li>
		

                      <li class="l-section section">
                        <div class="work">
                          <h2>Variable Profiling</h2>
				

							
							<body id="addOption_list";>
								<FORM name="drop_list" action="yourpage.php" >
										
								<SELECT id="DropList" NAME="DropList" >
								 <!--<Option value="" >Variables</option> -->
								</SELECT>
								</form>
								
								

                          <div class="radio-list-wrapper">
                            <!--<div id="dose" style="width:100%"></div>-->
							 
							<div id="plotdiv"></div>	
						
						<div id="plotdiv1"></div>
						<!--	<div id="myChart">
						  
						  <select id="chart-selector" name="chart-selector">
							
							<option value="">Please Select An Option</option>
							<option value="0">0</option>
							<option value="1">1</option>
							
						  </select>
						  
						</div>
						
                            <div id="variable-profiling" style="width:100%"></div>-->
                          </div>


                        </div>
                      </li>



                      <li class="l-section section">
                        <div class="about">

                          <div class="radio-list">

                            <h2>Select the Model</h2>

                            <div class="radio-list-cover">
                              <div class="radio">
                                <input id="select-1" name="radio" type="radio" checked>
                                <label for="select-1" class="radio-label">logistic regression</label>
                              </div>

                              <div class="radio">
                                <input id="select-2" name="radio" type="radio">
                                <label for="select-2" class="radio-label">random forest</label>
                              </div>

                              <div class="radio">
                                <input id="select-3" name="radio" type="radio">
                                <label for="select-3" class="radio-label">SVM</label>
                              </div>

                              <div class="radio">
                                <input id="select-4" name="radio" type="radio">
                                <label for="select-4" class="radio-label">GBM</label>
                              </div>

                              <div class="radio">
                                <input id="select-5" name="radio" type="radio">
                                <label for="select-5" class="radio-label">naive bayes</label>
                              </div>

                              <div class="radio">
                                <input id="select-6" name="radio" type="radio">
                                <label for="select-6" class="radio-label">neural network</label>
                              </div>

                              <div class="radio">
                                <input id="select-7" name="radio" type="radio">
                                <label for="select-7" class="radio-label">optimized essembled model</label>
                              </div>

                            </div>

                            <div>
                              <button>Show Performance</button>
                            </div>

                          </div>

                        </div>
                      </li>


                      <li class="l-section section">
                        <div class="contact--lockup">
                          <h2>Results</h2>
                          <div class="result-wrapper">

                            <div class="list">
                              <h6>Significant Variables</h6>
                              <ul>
                                <li>age</li>
                                <li>gender - female</li>
                                <li>BMI</li>
                                <li>country</li>
                                <li>region EMEA</li>
                                <li>salary</li>
                              </ul>
                            </div>

                            <div class="result-chart">
                              <div id="Result01"></div>
                              <div id="Result02"></div>
                              <table border="1">
                                <thead>
                                  <tr>
                                    <th></th>
                                    <th>Predicted: No</th>
                                    <th>Predicted: Yes</th>
                                  </tr>
                                </thead>

                                <tbody>

                                  <tr>
                                    <td>Actual: No</td>
                                    <td>50</td>
                                    <td>20</td>
                                  </tr>

                                  <tr>
                                    <td>Actual: Yes</td>
                                    <td>5</td>
                                    <td>100</td>
                                  </tr>

                                </tbody>
                              </table>
                            </div>

                          </div>
                        </div>
                      </li>


                      <li class="l-section section">
                        <div class="hire">


                          <div class="intro">
                            <h2>Evaluate Module</h2>
                            <div class="choose-data">
                              <span>Evaluation Dataset</span>
                              <span>
                                <input id="uploadFile2" disabled="disabled" />
                                <label class="custom-file-input">
                                  <input type="file" id="uploadBtn2">
                                </label>
                              </span>

                              <button>Upload</button>
				
				<div class="download-btn">
                              <button>Download Source</button>
                            </div>
				    
                            </div>
                          </div>

                          </div>





                        </div>
                      </li>



                    </ul>
                  </div>

                  
                </div>
              </div>
            </div>

          </div>


        </div>
      </div>
    </div>
  

   </div>
  </div>


  <ul class="outer-nav">
      <li class="is-active">Choose CSV</li>
      <li>Variable Profiling</li>
      <li>Select the Model</li>
      <li>Results</li>
      <li>Evaluate Model</li>
    </ul>


  </div>

</body>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="js/functions-min.js"></script>
<script src="js/high-chart-code.js"></script>
<script>
  document.getElementById("uploadBtn").onchange = function () {
    document.getElementById("uploadFile").value = this.value;
  };

  document.getElementById("uploadBtn2").onchange = function () {
    document.getElementById("uploadFile2").value = this.value;
  };
</script>

</html>
